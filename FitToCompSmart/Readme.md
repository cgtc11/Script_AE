Markdown
# Fit to Comp Smart for After Effects

選択したレイヤーをコンポジションのサイズに合わせて自動調整する After Effects 用スクリプトです。
単なるスケール調整だけでなく、**平面やシェイプレイヤーの内部サイズ（Source Size）を直接書き換える**機能を搭載しており、Scale 100% のまま画面サイズにフィットさせることが可能です。

## Features (特徴)

* **2つのリサイズモード**: 用途に合わせて「スケール合わせ」と「ソースサイズ変更」を選択可能。
* **Smart Source Resizing (Method 2)**:
    * **平面・調整レイヤー**: 平面設定そのものをコンポサイズに変更します（`Ctrl+Shift+Y` の挙動を自動化）。
    * **シェイプレイヤー**: 長方形パス（Rectangle）や楕円形パス（Ellipse）の「サイズプロパティ」を検索して書き換えます。
    * これらにより、トランスフォームの **Scale を 100% に保ったまま** リサイズできます。
* **画面を確実にカバー**: 縦横比が異なる場合でも、隙間ができないように画面全体を覆うように調整します（Method 1）。
* **完全なセンタリング**: アンカーポイントを修正し、画面中央（3Dレイヤー含む）に正確に配置します。
* **Undo 対応**: 実行内容は1つの Undo グループとして記録されるため、すぐに元に戻せます。